---
keywords: fastai
description: In this first chapter, you will get exposure to the Kaggle competition process. You will train a model and prepare a csv file ready for submission. You will learn the difference between Public and Private test splits, and how to prevent overfitting.
title: Winning a Kaggle Competition in Python - Part 1
toc: true
branch: master
badges: true
comments: true
author: Hai Nguyen
categories: [Kaggle, Datacamp, Machine Learning, Python, EDA]
image: images/winning_kaggle_p1.png
hide: false
search_exclude: true
metadata_key1: metadata_value1
metadata_key2: metadata_value2
nb_path: _notebooks/Winning a Kaggle Competition in Python/2022-08-03-Chapter_1 New York City Taxi Fare Prediction.ipynb
layout: notebook
---

<!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/Winning a Kaggle Competition in Python/2022-08-03-Chapter_1 New York City Taxi Fare Prediction.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://github.com/anhhaibkhn/Data-Science-selfstudy-notes-Blog/tree/master/_notebooks/Winning%20a%20Kaggle%20Competition%20in%20Python"><strong>Download Datasets and Presentation slides for this post HERE</strong></a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Competitions-overview">Competitions overview<a class="anchor-link" href="#Competitions-overview"> </a></h2><p><img src="/Data-Science-selfstudy-notes-Blog/images/copied_from_nb/./images/competition_overview.png" alt="Competition Overview"></p>
<ul>
<li>Explore train and test data</li>
</ul>
<p><img src="/Data-Science-selfstudy-notes-Blog/images/copied_from_nb/./images/taxi_dataset.png" alt="Competition Dataset"></p>
<p><img src="/Data-Science-selfstudy-notes-Blog/images/copied_from_nb/./images/train_test.png" alt="Train and Test sets"></p>
<p><img src="/Data-Science-selfstudy-notes-Blog/images/copied_from_nb/./images/sample_submisison.png" alt="Competition submisison"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Explore-Train-Data">Explore Train Data<a class="anchor-link" href="#Explore-Train-Data"> </a></h3><p>You will work with another Kaggle competition called "Store Item Demand Forecasting Challenge". In this competition, you are given 5 years of store-item sales data, and asked to predict 3 months of sales for 50 different items in 10 different stores.</p>
<p>To begin, let's explore the train data for this competition. For the faster performance, you will work with a subset of the train data containing only a single month history.</p>
<p>Your initial goal is to read the input data and take the first look at it.</p>
<p>Instructions:</p>
<ul>
<li>Import pandas as pd.</li>
<li>Read train data using pandas' read_csv() method.</li>
<li>Print the head of the train data (using head() method) to see the data sample.</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Read train data</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;datasets/demand_forecasting_train_1_month.csv&#39;</span><span class="p">)</span>

<span class="c1"># Look at the shape of the data</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Train shape:&#39;</span><span class="p">,</span> <span class="n">train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># Look at the head() of the data</span>
<span class="n">display</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Train shape: (15500, 5)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>date</th>
      <th>store</th>
      <th>item</th>
      <th>sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>100000</td>
      <td>2017-12-01</td>
      <td>1</td>
      <td>1</td>
      <td>19</td>
    </tr>
    <tr>
      <th>1</th>
      <td>100001</td>
      <td>2017-12-02</td>
      <td>1</td>
      <td>1</td>
      <td>16</td>
    </tr>
    <tr>
      <th>2</th>
      <td>100002</td>
      <td>2017-12-03</td>
      <td>1</td>
      <td>1</td>
      <td>31</td>
    </tr>
    <tr>
      <th>3</th>
      <td>100003</td>
      <td>2017-12-04</td>
      <td>1</td>
      <td>1</td>
      <td>7</td>
    </tr>
    <tr>
      <th>4</th>
      <td>100004</td>
      <td>2017-12-05</td>
      <td>1</td>
      <td>1</td>
      <td>20</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Congratulations, you've gotten started with your first Kaggle dataset! It contains 15,500 daily observations of the sales data.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Explore-test-data">Explore test data<a class="anchor-link" href="#Explore-test-data"> </a></h3><p>Having looked at the train data, let's explore the test data in the "Store Item Demand Forecasting Challenge". Remember, that the test dataset generally contains one column less than the train one.</p>
<p>This column, together with the output format, is presented in the sample submission file. Before making any progress in the competition, you should get familiar with the expected output.</p>
<p>That is why, let's look at the columns of the test dataset and compare it to the train columns. Additionally, let's explore the format of the sample submission. The train DataFrame is available in your worksp</p>
<p>Instructions:</p>
<ul>
<li>Read the test dataset.</li>
<li>Print the column names of the train and test datasets.</li>
<li>Notice that test columns do not have the target "sales" column. Now, read the sample submission file.</li>
<li>Look at the head of the submission file to get the output format.</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Read the test data</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;datasets\demand_forecasting_test.csv&#39;</span><span class="p">)</span>

<span class="c1"># Print train and test columns</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Train columns:&#39;</span><span class="p">,</span> <span class="n">train</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test columns:&#39;</span><span class="p">,</span> <span class="n">test</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="c1"># Read the sample submission file</span>
<span class="n">sample_submission</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;datasets\sample_submission.csv&#39;</span><span class="p">)</span>

<span class="c1"># Look at the head() of the sample submission</span>
<span class="n">display</span><span class="p">(</span><span class="n">sample_submission</span><span class="o">.</span><span class="n">head</span><span class="p">()</span> <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Train columns: [&#39;id&#39;, &#39;date&#39;, &#39;store&#39;, &#39;item&#39;, &#39;sales&#39;]
Test columns: [&#39;id&#39;, &#39;date&#39;, &#39;store&#39;, &#39;item&#39;]
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>52</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>52</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>52</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>52</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>52</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The sample submission file consists of two columns: id of the observation and sales column for your predictions. Kaggle will evaluate your predictions on the true sales data for the corresponding id. So, it’s important to keep track of the predictions by id before submitting them. Let’s jump in the next lesson to see how to prepare a submission file!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Prepare-for-your-first-submission">Prepare for your first submission<a class="anchor-link" href="#Prepare-for-your-first-submission"> </a></h2><p><img src="/Data-Science-selfstudy-notes-Blog/images/copied_from_nb/./images/submission.png" alt="Competition Submission"></p>
<p><img src="/Data-Science-selfstudy-notes-Blog/images/copied_from_nb/./images/taxi_dataset2.png" alt="Competition Dataset"></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Read train data</span>
<span class="n">taxi_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;datasets/taxi_train_chapter_4.csv&#39;</span><span class="p">)</span>
<span class="n">taxi_train</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;id&#39;,
 &#39;fare_amount&#39;,
 &#39;pickup_datetime&#39;,
 &#39;pickup_longitude&#39;,
 &#39;pickup_latitude&#39;,
 &#39;dropoff_longitude&#39;,
 &#39;dropoff_latitude&#39;,
 &#39;passenger_count&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Read test data</span>
<span class="n">taxi_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;datasets/taxi_test_chapter_4.csv&#39;</span><span class="p">)</span>
<span class="n">taxi_test</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;id&#39;,
 &#39;pickup_datetime&#39;,
 &#39;pickup_longitude&#39;,
 &#39;pickup_latitude&#39;,
 &#39;dropoff_longitude&#39;,
 &#39;dropoff_latitude&#39;,
 &#39;passenger_count&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>'fare_amount' column is missing in test data because this is the column that we are predicting.</p>
<ul>
<li>Problem Type</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># plot a histogram</span>
<span class="n">taxi_train</span><span class="o">.</span><span class="n">fare_amount</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we see the fare_amount is a continued value, so we are dealing with the Regression problem.</p>
<ul>
<li>Build a model:</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>

<span class="n">lr</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">feature_cols</span> <span class="o">=</span> <span class="p">[</span>   
                    <span class="s1">&#39;pickup_longitude&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;pickup_latitude&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;dropoff_longitude&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;dropoff_latitude&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;passenger_count&#39;</span>
                <span class="p">]</span>
                
<span class="n">lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">taxi_train</span><span class="p">[</span><span class="n">feature_cols</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">taxi_train</span><span class="p">[</span><span class="s1">&#39;fare_amount&#39;</span><span class="p">])</span>

<span class="c1"># make predictions on the test data</span>
<span class="n">taxi_test</span><span class="p">[</span><span class="s1">&#39;fare_amount&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">taxi_test</span><span class="p">[</span><span class="n">feature_cols</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">taxi_sample_sub</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;datasets/taxi_sample_submission.csv&#39;</span><span class="p">)</span>
<span class="n">taxi_sample_sub</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>fare_amount</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2015-01-27 13:08:24.0000002</td>
      <td>11.35</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2015-01-27 13:08:24.0000003</td>
      <td>11.35</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2011-10-08 11:53:44.0000002</td>
      <td>11.35</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2012-12-01 21:12:12.0000002</td>
      <td>11.35</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2012-12-01 21:12:12.0000003</td>
      <td>11.35</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">taxi_test</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>pickup_datetime</th>
      <th>pickup_longitude</th>
      <th>pickup_latitude</th>
      <th>dropoff_longitude</th>
      <th>dropoff_latitude</th>
      <th>passenger_count</th>
      <th>fare_amount</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>2015-01-27 13:08:24 UTC</td>
      <td>-73.973320</td>
      <td>40.763805</td>
      <td>-73.981430</td>
      <td>40.743835</td>
      <td>1</td>
      <td>11.235023</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2015-01-27 13:08:24 UTC</td>
      <td>-73.986862</td>
      <td>40.719383</td>
      <td>-73.998886</td>
      <td>40.739201</td>
      <td>1</td>
      <td>11.236369</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>2011-10-08 11:53:44 UTC</td>
      <td>-73.982524</td>
      <td>40.751260</td>
      <td>-73.979654</td>
      <td>40.746139</td>
      <td>1</td>
      <td>11.235279</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>2012-12-01 21:12:12 UTC</td>
      <td>-73.981160</td>
      <td>40.767807</td>
      <td>-73.990448</td>
      <td>40.751635</td>
      <td>1</td>
      <td>11.234863</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>2012-12-01 21:12:12 UTC</td>
      <td>-73.966046</td>
      <td>40.789775</td>
      <td>-73.988565</td>
      <td>40.744427</td>
      <td>1</td>
      <td>11.234457</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include note.html content='Ignore the following cell, as we do not need to submit to the competition.' %}</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">taxi_submission</span> <span class="o">=</span> <span class="n">taxi_test</span><span class="p">[[</span><span class="s1">&#39;key&#39;</span><span class="p">,</span><span class="s1">&#39;fare_amount&#39;</span><span class="p">]]</span>

<span class="c1"># save to .csv</span>
<span class="n">taxi_submission</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;first_sub.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Determine-a-problem-type">Determine a problem type<a class="anchor-link" href="#Determine-a-problem-type"> </a></h3><p>You will keep working on the Store Item Demand Forecasting Challenge. Recall that you are given a history of store-item sales data, and asked to predict 3 months of the future sales.</p>
<p>Before building a model, you should determine the problem type you are addressing. The goal of this exercise is to look at the distribution of the target variable, and select the correct problem type you will be building a model for.</p>
<p>The train DataFrame is already available in your workspace. It has the target variable column called "sales". Also, matplotlib.pyplot is already imported as plt.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span><span class="o">.</span><span class="n">sales</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>That's correct! The sales variable is <strong>continuous</strong>, so you're solving a regression problem.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Train-a-simple-model">Train a simple model<a class="anchor-link" href="#Train-a-simple-model"> </a></h3><p>As you determined, you are dealing with a regression problem. So, now you're ready to build a model for a subsequent submission. But now, instead of building the simplest Linear Regression model as in the slides, let's build an out-of-box Random Forest model.</p>
<p>You will use the RandomForestRegressor class from the scikit-learn library.</p>
<p>Your objective is to train a Random Forest model with default parameters on the "store" and "item" features.</p>
<p>Instructions:</p>
<ul>
<li>Read the train data using pandas.</li>
<li>Create a Random Forest object.</li>
<li>Train the Random Forest model on the "store" and "item" features with "sales" as a target.</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>


<span class="c1"># Create a Random Forest object</span>
<span class="n">rf</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">()</span>

<span class="c1"># Train a model</span>
<span class="n">rf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">train</span><span class="p">[[</span><span class="s1">&#39;store&#39;</span><span class="p">,</span> <span class="s1">&#39;item&#39;</span><span class="p">]],</span> <span class="n">y</span><span class="o">=</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;sales&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>RandomForestRegressor()</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Prepare-a-submission">Prepare a submission<a class="anchor-link" href="#Prepare-a-submission"> </a></h3><p>You've already built a model on the training data from the Kaggle Store Item Demand Forecasting Challenge. Now, it's time to make predictions on the test data and create a submission file in the specified format.</p>
<p>Your goal is to read the test data, make predictions, and save these in the format specified in the "sample_submission.csv" file. The rf object you created in the previous exercise is available in your workspace.</p>
<p>Note that starting from now and for the rest of the course, pandas library will be always imported for you and could be accessed as pd.</p>
<p>Instructions:</p>
<ul>
<li>Read "test.csv" and "sample_submission.csv" files using pandas.</li>
<li>Look at the head of the sample submission to determine the format.</li>
<li>Note that sample submission has id and sales columns. Now, make predictions on the test data using the rf model, that you fitted on the train data.</li>
<li>Using the format given in the sample submission, write your results to a new file.</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;datasets/taxi_test_chapter_4.csv&quot;</span><span class="p">)</span>
<span class="n">sample_submission</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;datasets/sample_submission.csv&quot;</span><span class="p">)</span>

<span class="c1"># Show the head() of the sample_submission</span>
<span class="n">display</span><span class="p">(</span><span class="n">sample_submission</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>52</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>52</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>52</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>52</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>52</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;sales&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test</span><span class="p">[[</span><span class="s1">&#39;store&#39;</span><span class="p">,</span> <span class="s1">&#39;item&#39;</span><span class="p">]])</span>

<span class="c1"># Write test predictions using the sample_submission format</span>
<span class="n">test</span><span class="p">[[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;sales&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;kaggle_submission.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Congratulations! You've prepared your first Kaggle submission. Now, you could upload it to the Kaggle platform and see your score and current position on the Leaderboard. Move forward to learn more about the Leaderboard itself!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Public-vs-Private-Leaderboard">Public vs Private Leaderboard<a class="anchor-link" href="#Public-vs-Private-Leaderboard"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Public-vs-Private-Leaderboard">Public vs Private Leaderboard<a class="anchor-link" href="#Public-vs-Private-Leaderboard"> </a></h3><p><img src="/Data-Science-selfstudy-notes-Blog/images/copied_from_nb/./images/competition_metrics.png" alt="Competition metrics"></p>
<p><img src="/Data-Science-selfstudy-notes-Blog/images/copied_from_nb/./images//test_split.png" alt="Test Split"></p>
<p><img src="/Data-Science-selfstudy-notes-Blog/images/copied_from_nb/./images/leaderboards.png" alt="Leaders Board"></p>
<p><img src="/Data-Science-selfstudy-notes-Blog/images/copied_from_nb/./images/overfitting.png" alt="Over Fitting"></p>
<p>Prepare a submission</p>
<p>You've already built a model on the training data from the Kaggle Store Item Demand Forecasting Challenge. Now, it's time to make predictions on the test data and create a submission file in the specified format.</p>
<p>Your goal is to read the test data, make predictions, and save these in the format specified in the "sample_submission.csv" file. The rf object you created in the previous exercise is available in your workspace.</p>
<p>Note that starting from now and for the rest of the course, pandas library will be always imported for you and could be accessed as pd.</p>
<p>Instructions:</p>
<ul>
<li>Note that sample submission has id and sales columns. Now, make predictions on the test data using the rf model, that you fitted on the train data.</li>
<li>Using the format given in the sample submission, write your results to a new file.</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./datasets/test.csv&#39;</span><span class="p">)</span>
<span class="n">sample_submission</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./datasets/sample_submission.csv&#39;</span><span class="p">)</span>

<span class="c1"># Show the head() of the sample_submission</span>
<span class="n">display</span><span class="p">(</span><span class="n">sample_submission</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>52</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>52</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>52</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>52</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>52</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Get predictions for the test set</span>
<span class="n">test</span><span class="p">[</span><span class="s1">&#39;sales&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test</span><span class="p">[[</span><span class="s1">&#39;store&#39;</span><span class="p">,</span> <span class="s1">&#39;item&#39;</span><span class="p">]])</span>

<span class="c1"># Write test predictions using the sample_submission format</span>
<span class="n">test</span><span class="p">[[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;sales&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;kaggle_submission.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Train-XGBoost-models">Train XGBoost models<a class="anchor-link" href="#Train-XGBoost-models"> </a></h3><p>Every Machine Learning method could potentially overfit. You will see it on this example with XGBoost. Again, you are working with the Store Item Demand Forecasting Challenge. The train DataFrame is available in your workspace.</p>
<p>Firstly, let's train multiple XGBoost models with different sets of hyperparameters using XGBoost's learning API. The single hyperparameter you will change is:</p>
<p>max_depth - maximum depth of a tree. Increasing this value will make the model more complex and more likely to overfit.
Instructions:</p>
<ul>
<li>Set the maximum depth to 2. Then hit Submit Answer button to train the first model.</li>
<li>Now, set the maximum depth to 8. Then hit Submit Answer button to train the second model.</li>
<li>Finally, set the maximum depth to 15. Then hit Submit Answer button to train the third model.</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_full</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;datasets/train.csv&#39;</span><span class="p">)</span>
<span class="c1"># test = pd.read_csv(&#39;datasets/test.csv&#39;)</span>

<span class="c1"># Randomly use 30000 of your dataframe</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df_full</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">30000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>


<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>


<span class="kn">import</span> <span class="nn">xgboost</span> <span class="k">as</span> <span class="nn">xgb</span>

<span class="c1"># Create DMatrix on train data</span>
<span class="n">dtrain</span> <span class="o">=</span> <span class="n">xgb</span><span class="o">.</span><span class="n">DMatrix</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">train</span><span class="p">[[</span><span class="s1">&#39;store&#39;</span><span class="p">,</span> <span class="s1">&#39;item&#39;</span><span class="p">]],</span>
                     <span class="n">label</span><span class="o">=</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;sales&#39;</span><span class="p">])</span>
<span class="c1"># dtest = xgb.DMatrix(data=test[[&#39;store&#39;, &#39;item&#39;]])</span>


<span class="c1"># Define xgboost parameters</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>  <span class="s1">&#39;objective&#39;</span><span class="p">:</span> <span class="s1">&#39;reg:linear&#39;</span><span class="p">,</span>
            <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="c1"># &#39;max_depth&#39;: 8,</span>
            <span class="c1"># &#39;max_depth&#39;: 15,</span>
            <span class="s1">&#39;verbosity&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>

<span class="c1"># Train xgboost model</span>
<span class="n">xg_depth_2</span> <span class="o">=</span> <span class="n">xgb</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">dtrain</span><span class="o">=</span><span class="n">dtrain</span><span class="p">)</span>


<span class="c1"># Define xgboost parameters</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>  <span class="s1">&#39;objective&#39;</span><span class="p">:</span> <span class="s1">&#39;reg:linear&#39;</span><span class="p">,</span>
            <span class="c1">#&#39;max_depth&#39;: 2,</span>
            <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
            <span class="c1"># &#39;max_depth&#39;: 15,</span>
            <span class="s1">&#39;verbosity&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>

<span class="c1"># Train xgboost model</span>
<span class="n">xg_depth_8</span> <span class="o">=</span> <span class="n">xgb</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">dtrain</span><span class="o">=</span><span class="n">dtrain</span><span class="p">)</span>

<span class="c1"># Define xgboost parameters</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>  <span class="s1">&#39;objective&#39;</span><span class="p">:</span> <span class="s1">&#39;reg:linear&#39;</span><span class="p">,</span>
            <span class="c1">#&#39;max_depth&#39;: 2,</span>
            <span class="c1"># &#39;max_depth&#39;: 8,</span>
            <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
            <span class="s1">&#39;verbosity&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>

<span class="c1"># Train xgboost model</span>
<span class="n">xg_depth_15</span> <span class="o">=</span> <span class="n">xgb</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">dtrain</span><span class="o">=</span><span class="n">dtrain</span><span class="p">)</span>

<span class="c1"># Define xgboost parameters</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>  <span class="s1">&#39;objective&#39;</span><span class="p">:</span> <span class="s1">&#39;reg:linear&#39;</span><span class="p">,</span>
            <span class="c1">#&#39;max_depth&#39;: 2,</span>
            <span class="c1"># &#39;max_depth&#39;: 8,</span>
            <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
            <span class="s1">&#39;verbosity&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>

<span class="c1"># Train xgboost model</span>
<span class="n">xg_depth_30</span> <span class="o">=</span> <span class="n">xgb</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">dtrain</span><span class="o">=</span><span class="n">dtrain</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 30000 entries, 782526 to 499585
Data columns (total 4 columns):
 #   Column  Non-Null Count  Dtype 
---  ------  --------------  ----- 
 0   date    30000 non-null  object
 1   store   30000 non-null  int64 
 2   item    30000 non-null  int64 
 3   sales   30000 non-null  int64 
dtypes: int64(3), object(1)
memory usage: 1.1+ MB
None
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Explore-overfitting-XGBoost">Explore overfitting XGBoost<a class="anchor-link" href="#Explore-overfitting-XGBoost"> </a></h3><p>Having trained 3 XGBoost models with different maximum depths, you will now evaluate their quality. For this purpose, you will measure the quality of each model on both the train data and the test data. As you know by now, the train data is the data models have been trained on. The test data is the next month sales data that models have never seen before.</p>
<p>The goal of this exercise is to determine whether any of the models trained is overfitting. To measure the quality of the models you will use Mean Squared Error (MSE). It's available in sklearn.metrics as mean_squared_error() function that takes two arguments: true values and predicted values.</p>
<p>train and test DataFrames together with 3 models trained (xg_depth_2, xg_depth_8, xg_depth_15) are available in your workspace.</p>
<ul>
<li><p>Instructions</p>
<ul>
<li>Make predictions for each model on both the train and test data.</li>
<li>Calculate the MSE between the true values and your predictions for both the train and test data.</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>

<span class="n">dtrain_</span> <span class="o">=</span> <span class="n">xgb</span><span class="o">.</span><span class="n">DMatrix</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">train</span><span class="p">[[</span><span class="s1">&#39;store&#39;</span><span class="p">,</span> <span class="s1">&#39;item&#39;</span><span class="p">]])</span>
<span class="n">dtest</span> <span class="o">=</span> <span class="n">xgb</span><span class="o">.</span><span class="n">DMatrix</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">test</span><span class="p">[[</span><span class="s1">&#39;store&#39;</span><span class="p">,</span> <span class="s1">&#39;item&#39;</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">train</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">))</span>

<span class="c1"># For each of 3 trained models</span>
<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="p">[</span><span class="n">xg_depth_2</span><span class="p">,</span> <span class="n">xg_depth_8</span><span class="p">,</span> <span class="n">xg_depth_15</span><span class="p">,</span><span class="n">xg_depth_30</span><span class="p">]:</span>
    <span class="c1"># Make predictions</span>
    <span class="n">train_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">dtrain_</span><span class="p">)</span>     
    <span class="n">test_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">dtest</span><span class="p">)</span>          
    
    <span class="c1"># Calculate metrics</span>
    <span class="n">mse_train</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;sales&#39;</span><span class="p">],</span> <span class="n">train_pred</span><span class="p">)</span>                  
    <span class="n">mse_test</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;sales&#39;</span><span class="p">],</span> <span class="n">test_pred</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="s1">&#39;MSE Train: </span><span class="si">{:.3f}</span><span class="s1">. MSE Test: </span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mse_train</span><span class="p">,</span> <span class="n">mse_test</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>15000 15000
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea ">
<pre>&#39;MSE Train: 600.630. MSE Test: 601.486&#39;</pre>
</div>

</div>

<div class="output_area">



<div class="output_text output_subarea ">
<pre>&#39;MSE Train: 295.394. MSE Test: 301.276&#39;</pre>
</div>

</div>

<div class="output_area">



<div class="output_text output_subarea ">
<pre>&#39;MSE Train: 252.848. MSE Test: 263.355&#39;</pre>
</div>

</div>

<div class="output_area">



<div class="output_text output_subarea ">
<pre>&#39;MSE Train: 251.809. MSE Test: 262.937&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

